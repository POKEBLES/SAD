<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin Dashboard - Waste Analytics</title>
  <link rel="stylesheet" href="index.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header class="dashboard-header">
    <div class="header-logo">
      <img src="https://tse1.mm.bing.net/th/id/OIP.7FZwq6jY3y6N8DpbxpyIagHaHa?pid=Api&P=0&h=180" alt="Partner Logo" class="header-logo-img-alt">
      <h1>Manila Waste Analytics</h1>
    </div>
    <nav class="header-nav">
      <a href="index.html"><i class="fa-solid fa-chart-pie"></i> Dashboard</a>
      <a href="data-management.html"><i class="fa-solid fa-file-csv"></i> Data Management</a>
      <a href="forecasting.html"><i class="fa-solid fa-chart-line"></i> Forecasting</a>
      <a href="clustering.html"><i class="fa-solid fa-users-viewfinder"></i> Clustering</a>
      <a href="reports.html"><i class="fa-solid fa-file-lines"></i> Reports</a>
      <a href="feedback.html"><i class="fa-solid fa-bullhorn"></i> Feedback</a>
      <a href="admin-dashboard.html" class="active"><i class="fa-solid fa-shield"></i> Admin</a>
      <a href="user-management.html"><i class="fa-solid fa-users"></i> Users</a>
    </nav>
    <div class="header-profile">
      <i class="fa-solid fa-user-circle" id="user-profile-icon" style="cursor: pointer; transition: transform 0.2s;" title="Click to view profile"></i>
    </div>
  </header>

  <script>
    document.getElementById('user-profile-icon').addEventListener('click', function(){
      window.location.href = 'user-profile.html';
    });
  </script>

  <main class="dashboard-container">
    <h2 class="dashboard-title">Administrative Dashboard</h2>

    <!-- System Status Banner -->
    <div id="admin-status" style="background:#F0F0F0;padding:12px;border-radius:4px;margin-bottom:16px;font-size:13px;border-left:4px solid #84994F">
      System Status: <strong id="sys-status-text">Ready</strong> | Last Activity: <span id="sys-last-activity">--:-- --</span>
    </div>

    <!-- Key Metrics / KPIs -->
    <section class="dashboard-card" style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:16px">
      <div style="background:#FFFACD;padding:12px;border-radius:4px;text-align:center;border:1px solid #DDD">
        <div style="font-size:24px;font-weight:bold;color:#84994F" id="kpi-reports">42</div>
        <div style="font-size:12px;color:#666">Total Reports</div>
      </div>
      <div style="background:#FFF0F5;padding:12px;border-radius:4px;text-align:center;border:1px solid #DDD">
        <div style="font-size:24px;font-weight:bold;color:#A72703" id="kpi-active-users">8</div>
        <div style="font-size:12px;color:#666">Active Users</div>
      </div>
      <div style="background:#E0F5FF;padding:12px;border-radius:4px;text-align:center;border:1px solid #DDD">
        <div style="font-size:24px;font-weight:bold;color:#0066CC" id="kpi-feedback">15</div>
        <div style="font-size:12px;color:#666">Feedback Items</div>
      </div>
      <div style="background:#F0FFF0;padding:12px;border-radius:4px;text-align:center;border:1px solid #DDD">
        <div style="font-size:24px;font-weight:bold;color:#339933" id="kpi-system-health">98%</div>
        <div style="font-size:12px;color:#666">System Health</div>
      </div>
    </section>

    <!-- Grid: Configuration & Analytics -->
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px">

      <!-- Configuration Section -->
      <div class="dashboard-card">
        <h3><i class="fa-solid fa-sliders"></i> System Configuration</h3>
        <div class="form-grid" style="gap:8px">
          <label>
            Dataset Upload
            <input type="file" id="dataset-upload" accept=".csv,.xlsx,.xls">
          </label>
          <button class="btn" id="upload-dataset-btn" style="width:100%;margin-top:4px"><i class="fa-solid fa-upload"></i> Upload Dataset</button>

          <hr style="margin:12px 0;border:none;border-top:1px solid #DDD">

          <label>
            Database Version
            <input type="text" id="db-version" value="v2.5.1" placeholder="Version">
          </label>
          <button class="btn" id="update-db-btn" style="width:100%;margin-top:4px"><i class="fa-solid fa-refresh"></i> Update Database</button>

          <hr style="margin:12px 0;border:none;border-top:1px solid #DDD">

          <label>
            Backup Schedule
            <select id="backup-schedule">
              <option>Daily</option>
              <option>Weekly</option>
              <option>Monthly</option>
            </select>
          </label>
          <button class="btn" id="trigger-backup-btn" style="width:100%;margin-top:4px"><i class="fa-solid fa-database"></i> Trigger Backup Now</button>
        </div>
      </div>

      <!-- Software Quality Indicators (ISO/IEC 9126) -->
      <div class="dashboard-card">
        <h3><i class="fa-solid fa-list-check"></i> Software Quality (ISO/IEC 9126)</h3>
        <div style="display:flex;flex-direction:column;gap:10px">
          <div>
            <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:4px">
              <span>Functionality</span>
              <span id="sq-functionality">92%</span>
            </div>
            <div style="background:#EEE;border-radius:2px;overflow:hidden;height:6px">
              <div style="background:#84994F;width:92%;height:100%"></div>
            </div>
          </div>
          <div>
            <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:4px">
              <span>Reliability</span>
              <span id="sq-reliability">88%</span>
            </div>
            <div style="background:#EEE;border-radius:2px;overflow:hidden;height:6px">
              <div style="background:#0066CC;width:88%;height:100%"></div>
            </div>
          </div>
          <div>
            <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:4px">
              <span>Usability</span>
              <span id="sq-usability">95%</span>
            </div>
            <div style="background:#EEE;border-radius:2px;overflow:hidden;height:6px">
              <div style="background:#339933;width:95%;height:100%"></div>
            </div>
          </div>
          <div>
            <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:4px">
              <span>Maintainability</span>
              <span id="sq-maintainability">85%</span>
            </div>
            <div style="background:#EEE;border-radius:2px;overflow:hidden;height:6px">
              <div style="background:#FFB700;width:85%;height:100%"></div>
            </div>
          </div>
          <div>
            <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:4px">
              <span>Portability</span>
              <span id="sq-portability">90%</span>
            </div>
            <div style="background:#EEE;border-radius:2px;overflow:hidden;height:6px">
              <div style="background:#A72703;width:90%;height:100%"></div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- User Activity Log -->
    <div class="dashboard-card">
      <h3><i class="fa-solid fa-history"></i> Recent User Activity</h3>
      <table class="table-wrap">
        <thead>
          <tr>
            <th>Timestamp</th>
            <th>User</th>
            <th>Role</th>
            <th>Action</th>
            <th>Resource</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="activity-log-tbody">
          <!-- populated by JS -->
        </tbody>
      </table>
    </div>

    <!-- Reports Summary -->
    <section style="display:grid;grid-template-columns:2fr 1fr;gap:16px;margin-top:16px">

      <div class="dashboard-card">
        <h3><i class="fa-solid fa-chart-bar"></i> Reports by Module (Last 30 Days)</h3>
        <canvas id="reportsChart" width="400" height="150"></canvas>
      </div>

      <div class="dashboard-card">
        <h3><i class="fa-solid fa-circle-exclamation"></i> System Alerts</h3>
        <div id="alerts-container" style="display:flex;flex-direction:column;gap:8px">
          <!-- populated by JS -->
        </div>
      </div>

    </section>

  </main>

  <footer style="text-align:center;padding:16px;color:#999;font-size:12px;margin-top:32px;border-top:1px solid #EEE">
    <p>Manila Waste Analytics &copy; 2025 | Admin System v2.5.1</p>
  </footer>

  <script>
    (function(){
      // Demo activity log data
      const activityLog = [
        {ts:'2025-11-12 14:32:15', user:'Maria Santos', role:'Admin', action:'Generated Report', resource:'Monthly Summary', status:'Success'},
        {ts:'2025-11-12 14:15:42', user:'Juan Dela Cruz', role:'Staff', action:'Uploaded Dataset', resource:'Q4_Data.csv', status:'Success'},
        {ts:'2025-11-12 13:48:20', user:'Ana Reyes', role:'Researcher', action:'Viewed Analytics', resource:'Clustering Dashboard', status:'Success'},
        {ts:'2025-11-12 13:22:08', user:'Carlos Mendez', role:'Staff', action:'Exported Report', resource:'District Forecast', status:'Success'},
        {ts:'2025-11-12 12:55:33', user:'Maria Santos', role:'Admin', action:'Updated Settings', resource:'Backup Schedule', status:'Success'},
        {ts:'2025-11-12 12:10:15', user:'Juan Dela Cruz', role:'Staff', action:'Viewed Report', resource:'Feedback Summary', status:'Success'},
      ];

      // Demo system alerts
      const systemAlerts = [
        {level:'warning', icon:'fa-triangle-exclamation', msg:'High database query time detected'},
        {level:'info', icon:'fa-circle-info', msg:'Backup completed successfully'},
        {level:'success', icon:'fa-check-circle', msg:'All systems operational'},
      ];

      // Populate activity log
      const tbody = document.getElementById('activity-log-tbody');
      activityLog.forEach(log=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td style="font-size:12px">${escapeHtml(log.ts)}</td>
          <td>${escapeHtml(log.user)}</td>
          <td><span style="background:#F0F0F0;padding:2px 6px;border-radius:3px;font-size:11px">${escapeHtml(log.role)}</span></td>
          <td>${escapeHtml(log.action)}</td>
          <td><code style="background:#F9F9F9;padding:2px 4px;border-radius:2px;font-size:11px">${escapeHtml(log.resource)}</code></td>
          <td><span style="color:#339933;font-weight:bold;font-size:12px">${escapeHtml(log.status)}</span></td>
        `;
        tbody.appendChild(tr);
      });

      // Populate alerts
      const alertsContainer = document.getElementById('alerts-container');
      systemAlerts.forEach(alert=>{
        const div = document.createElement('div');
        div.style.cssText = `padding:10px;border-radius:4px;border-left:3px solid;font-size:13px;display:flex;align-items:center;gap:8px`;
        const color = alert.level==='warning'?'#FFB700':(alert.level==='info'?'#0066CC':'#339933');
        const bgColor = alert.level==='warning'?'#FFFACD':(alert.level==='info'?'#E0F5FF':'#F0FFF0');
        div.style.borderLeftColor = color;
        div.style.backgroundColor = bgColor;
        div.innerHTML = `<i class="fa-solid ${alert.icon}" style="color:${color}"></i><span>${escapeHtml(alert.msg)}</span>`;
        alertsContainer.appendChild(div);
      });

      // Chart.js: Reports by Module
      if(typeof Chart !== 'undefined'){
        try{
          const chartCtx = document.getElementById('reportsChart');
          if(chartCtx){
            new Chart(chartCtx, {
              type:'bar',
              data:{
                labels:['Clustering','Forecasting','Data Mgmt','Feedback','Other'],
                datasets:[{
                  label:'Reports Generated',
                  data:[12,10,8,7,5],
                  backgroundColor:['#84994F','#0066CC','#FFB700','#339933','#A72703']
                }]
              },
              options:{
                responsive:true,
                maintainAspectRatio:false,
                plugins:{legend:{display:false}},
                scales:{y:{beginAtZero:true}}
              }
            });
          }
        }catch(e){ console.warn('Chart.js unavailable',e); }
      }

      // Event handlers
      document.getElementById('upload-dataset-btn').addEventListener('click',function(){
        const file = document.getElementById('dataset-upload').files[0];
        if(!file){ alert('Please select a file to upload.'); return; }
        alert(`Uploading ${file.name}...\\nDemo: File accepted and queued.`);
        document.getElementById('sys-status-text').textContent = 'Processing Dataset';
        setTimeout(()=>{ document.getElementById('sys-status-text').textContent = 'Ready'; },2000);
      });

      document.getElementById('update-db-btn').addEventListener('click',function(){
        const ver = document.getElementById('db-version').value;
        if(confirm(`Update database to ${ver}? This may take a few minutes.`)){
          alert('Demo: Database update initiated.\\nStatus will be updated shortly.');
          document.getElementById('sys-status-text').textContent = 'Updating Database';
          setTimeout(()=>{ document.getElementById('sys-status-text').textContent = 'Ready'; },3000);
        }
      });

      document.getElementById('trigger-backup-btn').addEventListener('click',function(){
        alert('Demo: Manual backup triggered.\\nBackup will proceed in background.');
        document.getElementById('sys-last-activity').textContent = new Date().toLocaleTimeString();
      });

      function escapeHtml(s){ return (s||'').toString().replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

      // Update last activity time on load
      document.getElementById('sys-last-activity').textContent = new Date().toLocaleTimeString();
    })();
  </script>
</body>
</html>
