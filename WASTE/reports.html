<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Reports & Visualization - Waste Analytics</title>
  <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
<header class="dashboard-header">
    <div class="header-logo">
      <img src="https://tse1.mm.bing.net/th/id/OIP.7FZwq6jY3y6N8DpbxpyIagHaHa?pid=Api&P=0&h=180" alt="Partner Logo" class="header-logo-img-alt">
      <h1>Manila Waste Analytics</h1>
    </div>
    <nav class="header-nav">
     <a href="index.html"><i class="fa-solid fa-chart-pie"></i> Dashboard</a>
      <a href="data-management.html"><i class="fa-solid fa-file-csv"></i> Data Management</a>
      <a href="forecasting.html"><i class="fa-solid fa-chart-line"></i> Forecasting</a>
      <a href="clustering.html"><i class="fa-solid fa-users-viewfinder"></i> Clustering</a>
      <a href="reports.html" class="active"><i class="fa-solid fa-file-lines"></i> Reports</a>
      <a href="feedback.html"><i class="fa-solid fa-bullhorn"></i> Feedback</a>
      <a href="admin-dashboard.html"><i class="fa-solid fa-shield"></i> Admin</a>
      <a href="user-management.html"><i class="fa-solid fa-users"></i> Users</a>
    </nav>
    <div class="header-profile">
      <i class="fa-solid fa-user-circle" id="user-profile-icon" style="cursor: pointer; transition: transform 0.2s;" title="Click to view profile"></i>
    </div>
  </header>

  <script>
    document.getElementById('user-profile-icon').addEventListener('click', function(){
      window.location.href = 'user-profile.html';
    });
  </script>

  <main class="dashboard-container">
    <h2 class="dashboard-title">Official Reports</h2>

  <!-- Status banner: shows load/state/errors for diagnostics -->
  <div id="reports-status" role="status" aria-live="polite" style="padding:8px;border-radius:6px;margin-top:8px;margin-bottom:12px;background:#fff8e1;border:1px solid #ffe58a;color:#6a4b00">Loading reports...</div>

    <!-- Top filters -->
    <div class="dashboard-card" style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
      <label>From <input type="date" id="filter-from"></label>
      <label>To <input type="date" id="filter-to"></label>
      <label>District <select id="filter-district"><option value="">All</option><option>District I</option><option>District II</option><option>District III</option><option>District IV</option></select></label>
      <label>Report Type <select id="filter-report"><option value="summary">Summary</option><option value="detailed">Detailed</option></select></label>
      <div style="margin-left:auto;display:flex;gap:8px">
        <button id="generate-pdf" class="btn btn-primary">Generate PDF</button>
        <button id="generate-excel" class="btn">Generate Excel</button>
      </div>
    </div>

    <!-- Visuals -->
    <div class="dashboard-card" style="margin-top:16px;display:grid;grid-template-columns:1fr 1fr;gap:12px">
      <div>
        <h3>Waste Composition</h3>
        <canvas id="pieChart" height="220"></canvas>
      </div>
      <div>
        <h3>Compliance per Barangay</h3>
        <canvas id="barChart" height="220"></canvas>
      </div>
    </div>

    <div class="dashboard-card" style="margin-top:16px">
      <h3>Waste vs Compliance Heatmap</h3>
      <div id="heatmap" class="heatmap-grid" style="padding:6px"></div>
    </div>

    <div style="height:20px"></div>

  </main>

  <!-- Modal for popped-out charts -->
  <div id="chart-modal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);align-items:center;justify-content:center;z-index:9999">
    <div style="background:#fff;border-radius:8px;max-width:90%;max-height:90%;overflow:auto;padding:12px;box-shadow:0 8px 24px rgba(0,0,0,0.3);position:relative;">
      <button id="chart-modal-close" style="position:absolute;right:10px;top:10px;border:none;background:transparent;font-size:18px;cursor:pointer">âœ•</button>
      <h3 id="chart-modal-title" style="margin:0 0 10px 0">Chart</h3>
      <div style="text-align:center"><img id="chart-modal-img" src="" alt="Chart" style="max-width:100%;height:auto;border:1px solid #eee;border-radius:4px"></div>
      <div style="display:flex;gap:8px;justify-content:center;margin-top:10px">
        <button id="chart-download" class="btn">Download PNG</button>
        <button id="chart-print" class="btn btn-primary">Print</button>
      </div>
    </div>
  </div>

  <script src="reports.js"></script>
</body>
</html>
